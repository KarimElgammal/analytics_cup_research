{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Finding Alvarez (and Others) in the A-League","text":"<p>Player archetype matching using SkillCorner tracking data</p> <p>A player similarity study for identifying A-League players who match world-class archetypes. Define an archetype (like Julian Alvarez's intelligent movement style), and find similar players using SkillCorner broadcast tracking data.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>12 Pre-built Archetypes: Computed from real StatsBomb World Cup 2022 data</li> <li>ML-Calibrated Weights: GradientBoosting models for each position type</li> <li>Profile Building: Automatically extract player profiles from SkillCorner tracking data</li> <li>Similarity Scoring: Rank players by weighted cosine similarity</li> <li>AI Scouting Insights: Position-aware LLM recommendations via GitHub Models API</li> <li>Interactive App: Streamlit-based comparison tool with radar charts and AI analysis</li> </ul>"},{"location":"#available-archetypes","title":"Available Archetypes","text":"Position Players ML Model AUC Forward Alvarez, Giroud, Kane, Lewandowski, Rashford, En-Nesyri 0.656 Defender Gvardiol, Romero, Hakimi 0.845 Goalkeeper Lloris, Livakovic, Bounou 0.993"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code># Clone and run (handles everything automatically)\ngit clone https://github.com/KarimElgammal/analytics_cup_research.git\ncd analytics_cup_research\n./run.sh\n</code></pre>"},{"location":"#quick-example","title":"Quick Example","text":"<pre><code>from src.core.archetype import Archetype\nfrom src.core.similarity import SimilarityEngine\n\n# Load archetype from StatsBomb data (12 players available)\narchetype = Archetype.from_statsbomb(\"alvarez\")\nprint(archetype.description)  # Shows actual World Cup 2022 stats\n\n# See all available archetypes\nprint(Archetype.list_available())\n# ['alvarez', 'giroud', 'kane', 'lewandowski', 'rashford', 'en_nesyri',\n#  'gvardiol', 'romero', 'hakimi', 'lloris', 'livakovic', 'bounou']\n\n# Compute similarity rankings against your player profiles\nengine = SimilarityEngine(archetype)\nengine.fit(profiles)  # Your SkillCorner player profiles\nrankings = engine.rank(top_n=10)\n\n# Display results\nfor row in rankings.to_dicts():\n    print(f\"{row['rank']}. {row['player_name']} - {row['similarity_score']:.1f}%\")\n</code></pre>"},{"location":"#a-league-results","title":"A-League Results","text":"<p>Using 10 A-League matches, the analysis identified Z. Clough (Adelaide United) as the closest match to the Alvarez archetype with an 87.9% similarity score. See Examples for full results and figures.</p>"},{"location":"#project-origin","title":"Project Origin","text":"<p>Developed for the SkillCorner X PySport Analytics Cup 2026 Research Track. The research question: \"Can SkillCorner tracking data identify A-League players with specific archetype characteristics?\"</p>"},{"location":"#next-steps","title":"Next Steps","text":"<ul> <li>Getting Started - Installation and setup</li> <li>Methodology - Full technical documentation with ML model details</li> <li>User Guide - Learn how to define archetypes</li> <li>AI Reports - Position-aware AI scouting insights</li> <li>Examples - Full A-League results with figures</li> <li>API Reference - Complete API documentation</li> </ul>"},{"location":"examples/","title":"Examples","text":""},{"location":"examples/#a-league-analysis-results","title":"A-League Analysis Results","text":"<p>This example shows results from analysing 10 A-League matches using 12 pre-built archetypes across forwards, defenders, and goalkeepers.</p>"},{"location":"examples/#data-summary","title":"Data Summary","text":"<ul> <li>245 final third entries detected (forwards)</li> <li>8,911 defensive engagements detected (defenders)</li> <li>522 goalkeeper distributions detected</li> <li>10 matches analysed</li> </ul>"},{"location":"examples/#top-5-alvarez-like-players-forwards","title":"Top 5 Alvarez-like Players (Forwards)","text":"Rank Player Age Team Similarity Danger Rate Entries 1 Z. Clough 29 Adelaide United 88.7% 50.0% 4 2 Z. Machach 25 Melbourne Victory 84.4% 42.9% 7 3 T. Payne 21 Wellington Phoenix 83.9% 25.0% 4 4 G. May 22 Auckland FC 80.7% 55.6% 9 5 T. Imai 27 Western United 79.8% 40.0% 5"},{"location":"examples/#similarity-rankings","title":"Similarity Rankings","text":"<p>Z. Clough from Adelaide United emerges as the closest match with an 88.7% similarity score. His 50% danger rate means half his final third entries led to shooting opportunities, mirroring Alvarez's clinical finishing.</p>"},{"location":"examples/#profile-comparison","title":"Profile Comparison","text":"<p>The radar chart compares the top 3 candidates against the Alvarez target profile (dashed orange line). The target emphasises high separation, danger rate, and central positioning while setting a low carry percentage, reflecting that Alvarez creates through movement rather than dribbling.</p>"},{"location":"examples/#code-finding-similar-players","title":"Code: Finding Similar Players","text":"<pre><code>from src.core.archetype import Archetype\nfrom src.core.similarity import SimilarityEngine\n\n# See all 12 available archetypes\nprint(Archetype.list_available())\n# ['alvarez', 'giroud', 'kane', 'lewandowski', 'rashford', 'en_nesyri',\n#  'gvardiol', 'romero', 'hakimi', 'lloris', 'livakovic', 'bounou']\n\n# Load any archetype from StatsBomb World Cup 2022 data\narchetype = Archetype.from_statsbomb(\"alvarez\")\nprint(archetype.description)  # Shows actual stats\n\n# Compute similarity against player profiles\nengine = SimilarityEngine(archetype)\nengine.fit(profiles)\nrankings = engine.rank(top_n=10)\n\n# Display results\nfor row in rankings.to_dicts():\n    print(f\"{row['rank']}. {row['player_name']} - {row['similarity_score']:.1f}%\")\n</code></pre>"},{"location":"examples/#code-multi-position-analysis","title":"Code: Multi-Position Analysis","text":"<p>Analyse players across different positions:</p> <pre><code>from src.core.archetype import Archetype\nfrom src.core.similarity import SimilarityEngine\n\n# Forward analysis\nforward_archetype = Archetype.from_statsbomb(\"giroud\")  # Target man\nengine = SimilarityEngine(forward_archetype)\nengine.fit(forward_profiles)\nforward_rankings = engine.rank(top_n=5)\n\n# Defender analysis\ndefender_archetype = Archetype.from_statsbomb(\"hakimi\")  # Attacking wing-back\nengine = SimilarityEngine(defender_archetype)\nengine.fit(defender_profiles)\ndefender_rankings = engine.rank(top_n=5)\n\n# Goalkeeper analysis\ngk_archetype = Archetype.from_statsbomb(\"lloris\")  # Sweeper-keeper\nengine = SimilarityEngine(gk_archetype)\nengine.fit(goalkeeper_profiles)\ngk_rankings = engine.rank(top_n=5)\n</code></pre>"},{"location":"examples/#code-custom-archetype","title":"Code: Custom Archetype","text":"<p>Create your own archetype for different player types:</p> <pre><code>from src.core.archetype import Archetype\nfrom src.core.similarity import SimilarityEngine\n\n# Define a \"pressing forward\" archetype\npressing_forward = Archetype.custom(\n    \"pressing_forward\",\n    \"High-energy forward who creates through pressing and quick transitions\"\n)\n\n# Set features: speed and counter-attacks matter most\npressing_forward.set_feature(\"avg_entry_speed\", target=85, weight=0.25, direction=1)\npressing_forward.set_feature(\"quick_break_pct\", target=80, weight=0.20, direction=1)\npressing_forward.set_feature(\"danger_rate\", target=70, weight=0.20, direction=1)\npressing_forward.set_feature(\"avg_defensive_line_dist\", target=30, weight=0.15, direction=-1)\npressing_forward.set_feature(\"avg_separation\", target=60, weight=0.10, direction=1)\npressing_forward.set_feature(\"central_pct\", target=50, weight=0.10, direction=1)\n\n# Validate weights sum to ~1.0\nwarnings = pressing_forward.validate()\nif warnings:\n    print(\"Warnings:\", warnings)\n\n# Use it\nengine = SimilarityEngine(pressing_forward)\nengine.fit(profiler.profiles)\nrankings = engine.rank(top_n=5)\n</code></pre>"},{"location":"examples/#code-comparing-archetypes","title":"Code: Comparing Archetypes","text":"<p>Find which archetype a player best matches:</p> <pre><code>from src.core.archetype import Archetype\nfrom src.core.similarity import SimilarityEngine\n\n# Compare against multiple archetypes\narchetypes = {\n    \"alvarez\": Archetype.from_statsbomb(\"alvarez\"),\n    \"giroud\": Archetype.from_statsbomb(\"giroud\"),\n    \"rashford\": Archetype.from_statsbomb(\"rashford\"),\n}\n\nplayer_name = \"Z. Clough\"\n\nprint(f\"Archetype fit for {player_name}:\")\nfor name, archetype in archetypes.items():\n    engine = SimilarityEngine(archetype)\n    engine.fit(profiles)\n    explanation = engine.explain(player_name)\n    print(f\"  {name}: {explanation['similarity_score']:.1f}%\")\n</code></pre>"},{"location":"examples/#code-ai-scouting-insights","title":"Code: AI Scouting Insights","text":"<p>Generate position-aware AI recommendations:</p> <pre><code>from src.utils.ai_insights import generate_similarity_insight, has_valid_token\n\n# check token exists\nif has_valid_token():\n    # forward analysis\n    insight = generate_similarity_insight(\n        forward_rankings,\n        Archetype.from_statsbomb(\"alvarez\"),\n        top_n=5,\n        position_type=\"forward\",\n    )\n    print(insight)\n\n    # defender analysis\n    insight = generate_similarity_insight(\n        defender_rankings,\n        defender_archetype,\n        top_n=5,\n        position_type=\"defender\",\n    )\n    print(insight)\n</code></pre>"},{"location":"examples/#example-ai-output-forward","title":"Example AI Output (Forward)","text":"<p>Z. Clough from Adelaide United emerges as the closest match with 88.7% similarity. His 50% danger rate mirrors Alvarez's clinical finishing, though with fewer entries (4 vs typical 8+).</p> <p>The key difference between Clough and the archetype lies in movement patterns. While he shows strong separation (8.2m), his central percentage is lower than target.</p> <p>For development potential, T. Payne at 22 offers interesting upside. His entry speed and willingness to attack centrally align with Alvarez's profile.</p>"},{"location":"examples/#example-ai-output-defender","title":"Example AI Output (Defender)","text":"<p>N. Paull leads the rankings with 82.4% similarity to Gvardiol. His stop danger rate of 68% and pressing rate of 72% suggest a similarly aggressive defensive approach.</p> <p>Unlike Gvardiol who excels at carrying the ball out, Paull shows lower progression metrics but stronger tackling numbers. This suggests a more traditional centre-back profile.</p>"},{"location":"examples/#example-ai-output-goalkeeper","title":"Example AI Output (Goalkeeper)","text":"<p>H. Devenish-Meares shows 91.2% similarity to Lloris with excellent pass success (87%) and quick distribution tendency.</p> <p>At 22, he represents the strongest development prospect among the top candidates. His preference for short distribution matches the sweeper-keeper archetype.</p>"},{"location":"getting-started/","title":"Getting Started","text":""},{"location":"getting-started/#quick-start-recommended","title":"Quick Start (Recommended)","text":"<p>The app launcher handles everything automatically:</p> <pre><code>git clone https://github.com/KarimElgammal/analytics_cup_research.git\ncd analytics_cup_research\n./run.sh\n</code></pre> <p>This will: 1. Install <code>uv</code> if not present 2. Create a Python 3.12 virtual environment 3. Install all dependencies 4. Launch the Streamlit app</p>"},{"location":"getting-started/#manual-installation","title":"Manual Installation","text":""},{"location":"getting-started/#option-1-using-uv-recommended","title":"Option 1: Using uv (Recommended)","text":"<p>uv is a fast Python package manager:</p> <pre><code># Install uv\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n\n# Setup project\ngit clone https://github.com/KarimElgammal/analytics_cup_research.git\ncd analytics_cup_research\nuv venv --python 3.12\nuv pip install -r requirements.txt\n</code></pre>"},{"location":"getting-started/#option-2-using-pip","title":"Option 2: Using pip","text":"<pre><code>git clone https://github.com/KarimElgammal/analytics_cup_research.git\ncd analytics_cup_research\npython -m venv .venv\nsource .venv/bin/activate  # On Windows: .venv\\Scripts\\activate\npip install -r requirements.txt\n</code></pre>"},{"location":"getting-started/#running","title":"Running","text":""},{"location":"getting-started/#interactive-app","title":"Interactive App","text":"<pre><code>./run.sh\n# Or manually:\nuv run streamlit run app.py\n</code></pre>"},{"location":"getting-started/#research-notebook","title":"Research Notebook","text":"<pre><code>uv run jupyter notebook submission.ipynb\n# Or with pip:\njupyter notebook submission.ipynb\n</code></pre>"},{"location":"getting-started/#basic-usage","title":"Basic Usage","text":"<pre><code>from src.core.archetype import Archetype\nfrom src.core.similarity import SimilarityEngine\nfrom src.data.loader import load_all_events, add_team_names\nfrom src.analysis.entries import detect_entries, classify_entries\nfrom src.analysis.profiles import build_player_profiles, filter_profiles\n\n# Load and process SkillCorner data\nevents = load_all_events()\nevents = add_team_names(events)\nentries = detect_entries(events)\nentries = classify_entries(entries)\nprofiles = build_player_profiles(entries)\nprofiles = filter_profiles(profiles, min_entries=3)\n\n# Load archetype from StatsBomb data (12 available)\narchetype = Archetype.from_statsbomb(\"alvarez\")\nprint(archetype.description)  # Shows actual stats\n\n# Compute similarity rankings\nengine = SimilarityEngine(archetype)\nengine.fit(profiles)\nrankings = engine.rank(top_n=10)\n\n# Display results\nfor row in rankings.to_dicts():\n    print(f\"{row['rank']}. {row['player_name']} - {row['similarity_score']:.1f}%\")\n</code></pre>"},{"location":"getting-started/#available-archetypes","title":"Available Archetypes","text":"<p>Load any of these 12 pre-built archetypes:</p> <pre><code># List all available\nArchetype.list_available()\n# ['alvarez', 'giroud', 'kane', 'lewandowski', 'rashford', 'en_nesyri',\n#  'gvardiol', 'romero', 'hakimi', 'lloris', 'livakovic', 'bounou']\n\n# Load specific archetype\narchetype = Archetype.from_statsbomb(\"giroud\")   # Target man style\narchetype = Archetype.from_statsbomb(\"rashford\") # Pace/dribbling style\narchetype = Archetype.from_statsbomb(\"gvardiol\") # Ball-playing CB\narchetype = Archetype.from_statsbomb(\"hakimi\")   # Attacking wing-back\n</code></pre>"},{"location":"methodology/","title":"Methodology: Finding Alvarez in the A-League","text":"<p>Online Documentation: karimelgammal.github.io/analytics_cup_research</p> <p>Repository: github.com/KarimElgammal/analytics_cup_research</p>"},{"location":"methodology/#overview","title":"Overview","text":"<p>This document explains how I derive player archetypes from StatsBomb event data and map them to SkillCorner tracking metrics for player similarity analysis.</p>"},{"location":"methodology/#programmatic-archetype-generation","title":"Programmatic Archetype Generation","text":"<p>Archetypes are computed programmatically from real StatsBomb event data.</p> <pre><code>from src.core.archetype import Archetype\n\n# Load archetype from StatsBomb data\narchetype = Archetype.from_statsbomb(\"alvarez\")\nprint(archetype.description)  # Shows actual stats\n\n# Available players (12 archetypes across 3 positions)\nArchetype.list_available()\n# ['alvarez', 'giroud', 'kane', 'lewandowski', 'rashford', 'en_nesyri',\n#  'gvardiol', 'romero', 'hakimi', 'lloris', 'livakovic', 'bounou']\n</code></pre> <p>The <code>src/statsbomb/</code> package handles: - loader.py: Fetches events from StatsBomb free data API - registry.py: Maps player keys to StatsBomb names and competition IDs - stats.py: Calculates shooting, passing, dribbling statistics - mapper.py: Converts StatsBomb metrics to SkillCorner target profiles</p>"},{"location":"methodology/#alvarez-target-profile-computed-from-statsbomb","title":"Alvarez Target Profile (Computed from StatsBomb)","text":"<p>The archetype is computed from real data. Example output from World Cup 2022:</p> Metric Actual Value Interpretation Shots 11 Active in attack Goals 4 Clinical finisher Conversion Rate 36.4% Elite finishing Shot Accuracy 72.7% Very accurate Dribble Success 0.0% NOT a dribbler Box Touches 8 Finds dangerous positions <p>The low dribble success is critical: Alvarez creates through movement and positioning, not individual dribbling. This maps to a low <code>carry_pct</code> target, penalising dribble-reliant players.</p>"},{"location":"methodology/#mapping-to-skillcorner-targets","title":"Mapping to SkillCorner Targets","text":"StatsBomb Metric SkillCorner Target Percentile Mapping Conversion Rate <code>danger_rate</code> 36.4% \u2192 ~95th percentile Box Touches/90 <code>avg_separation</code> High box presence \u2192 good separation Pass Accuracy <code>avg_passing_options</code> 78.9% \u2192 ~50th percentile Dribble Success <code>carry_pct</code> 0% \u2192 very low target <p>Fixed values for tracking-specific metrics (no StatsBomb equivalent): - <code>central_pct</code>: 70 (forwards typically central) - <code>avg_entry_speed</code>: 65 (moderate, not pace-reliant) - <code>half_space_pct</code>: 55 (some half-space movement)</p>"},{"location":"methodology/#part-1-statsbomb-integration-current-implementation","title":"Part 1: StatsBomb Integration (Current Implementation)","text":""},{"location":"methodology/#using-the-statsbomb-package","title":"Using the StatsBomb Package","text":"<p>The <code>src/statsbomb/</code> package provides a clean API for loading player data:</p> <pre><code>from src.statsbomb.loader import StatsBombLoader\nfrom src.statsbomb.stats import calculate_player_stats\nfrom src.statsbomb.registry import get_player_info\n\n# Initialize loader\nloader = StatsBombLoader()\n\n# Get player info\ninfo = get_player_info(\"alvarez\")\n# {'player_name': 'Juli\u00e1n \u00c1lvarez', 'display_name': 'Julian Alvarez', ...}\n\n# Load events from World Cup 2022\nevents = loader.get_player_events(\n    player_name=info[\"player_name\"],\n    competitions=[(43, 106)]  # World Cup 2022\n)\n\n# Calculate statistics\nstats = calculate_player_stats(events)\nprint(f\"Conversion: {stats.conversion_rate:.1f}%\")\nprint(f\"Dribble Success: {stats.dribble_success:.1f}%\")\n</code></pre>"},{"location":"methodology/#player-registry","title":"Player Registry","text":"<p>Available players are defined in <code>src/statsbomb/registry.py</code>:</p> <pre><code>PLAYER_REGISTRY = {\n    \"alvarez\": {\n        \"player_name\": \"Juli\u00e1n \u00c1lvarez\",\n        \"display_name\": \"Julian Alvarez\",\n        \"position\": \"Forward\",\n        \"style\": \"Movement-focused, intelligent runs, clinical finishing\",\n        \"competitions\": [(43, 106, \"FIFA World Cup 2022\")],\n    },\n    \"giroud\": {\n        \"player_name\": \"Olivier Giroud\",\n        \"display_name\": \"Olivier Giroud\",\n        \"position\": \"Forward\",\n        \"style\": \"Target man, hold-up play, aerial threat, 0% dribble reliance\",\n        \"competitions\": [(43, 106, \"FIFA World Cup 2022\")],\n    },\n    \"kane\": {\n        \"player_name\": \"Harry Kane\",\n        \"display_name\": \"Harry Kane\",\n        \"position\": \"Forward\",\n        \"style\": \"Complete forward, link-up play, clinical finishing\",\n        \"competitions\": [(43, 106, \"FIFA World Cup 2022\")],\n    },\n    # ... plus lewandowski, rashford, en_nesyri, gvardiol, romero, lloris, livakovic\n}\n</code></pre>"},{"location":"methodology/#computed-player-profiles-world-cup-2022","title":"Computed Player Profiles (World Cup 2022)","text":"Player Conversion Shot Accuracy Dribble Success Style Alvarez 36.4% 72.7% 0.0% Movement-focused Giroud 23.5% 58.8% 0.0% Target man Kane 16.7% 50.0% 43% Complete forward Rashford 27.3% 54.5% 60% Pace + dribbling <p>The key insight: Both Alvarez and Giroud have 0% dribble success. They create through movement, not dribbling. This distinguishes them from pace-reliant players like Rashford.</p>"},{"location":"methodology/#part-2-mapping-statsbomb-skillcorner","title":"Part 2: Mapping StatsBomb \u2192 SkillCorner","text":""},{"location":"methodology/#the-challenge","title":"The Challenge","text":"<p>StatsBomb provides event data (shots, passes, dribbles), while SkillCorner provides tracking data (positions, speeds, separations). We must map concepts, not metrics directly.</p>"},{"location":"methodology/#mapping-table","title":"Mapping Table","text":"Alvarez Trait (StatsBomb) SkillCorner Metric Rationale 36.4% conversion rate <code>danger_rate</code> Entries leading to shots proxy finishing quality 8 box touches <code>central_pct</code> Central entries = box presence Intelligent movement <code>avg_separation</code> Finding space between lines NOT a dribbler (0%) <code>carry_pct</code> (LOW weight) Carries \u2260 dribbles in tracking Link-up play <code>avg_passing_options</code> More options = better link-up High-pressure performer <code>quick_break_pct</code> Counter-attacks test composure"},{"location":"methodology/#part-2b-loading-a-league-data-with-kloppy","title":"Part 2B: Loading A-League Data with Kloppy","text":""},{"location":"methodology/#skillcorner-open-data-via-kloppy","title":"SkillCorner Open Data via Kloppy","text":"<p>Kloppy provides a standardised way to load SkillCorner tracking data:</p> <pre><code>\"\"\"Load SkillCorner A-League data with kloppy.\"\"\"\nfrom kloppy import skillcorner\n\n# Load tracking data for a match (frame-by-frame positions)\ndataset = skillcorner.load_open_data(\n    match_id=2017461,  # Melbourne Victory vs Auckland FC\n    include_event_data=True\n)\n\n# Access frames\nfor frame in dataset:\n    # frame.ball_coordinates\n    # frame.players_data (dict of player_id -&gt; PlayerData)\n    pass\n\n# Convert to DataFrame\ndf = dataset.to_df()\n</code></pre>"},{"location":"methodology/#why-we-use-dynamic-events-instead","title":"Why We Use Dynamic Events Instead","text":"<p>For this research, I use the dynamic_events.csv files directly because they contain pre-computed game intelligence metrics:</p> <pre><code>\"\"\"Load SkillCorner dynamic events (game intelligence).\"\"\"\nimport polars as pl\n\nGITHUB_BASE_URL = \"https://raw.githubusercontent.com/SkillCorner/opendata/master/data\"\nMATCH_IDS = [2017461, 2015213, 2013725, 2011166, 2006229,\n             1996435, 1953632, 1925299, 1899585, 1886347]\n\ndef load_events(match_id: int) -&gt; pl.DataFrame:\n    \"\"\"Load dynamic events for a single match.\"\"\"\n    url = f\"{GITHUB_BASE_URL}/matches/{match_id}/{match_id}_dynamic_events.csv\"\n    return pl.read_csv(url, infer_schema_length=10000)\n\ndef load_all_events() -&gt; pl.DataFrame:\n    \"\"\"Load all matches.\"\"\"\n    dfs = [load_events(mid).with_columns(pl.lit(mid).alias(\"match_id\"))\n           for mid in MATCH_IDS]\n    return pl.concat(dfs, how=\"diagonal\")\n\n# Available columns include:\n# - speed_avg, distance_covered (physical)\n# - separation_end, delta_to_last_defensive_line_end (spatial)\n# - n_passing_options_ahead, n_teammates_ahead_end (tactical)\n# - third_start, third_end, channel_end (zones)\n# - lead_to_shot, lead_to_goal (outcomes)\n</code></pre>"},{"location":"methodology/#detecting-final-third-entries","title":"Detecting Final Third Entries","text":"<pre><code>def detect_entries(events: pl.DataFrame) -&gt; pl.DataFrame:\n    \"\"\"Detect final third entries.\"\"\"\n    return events.filter(\n        (pl.col(\"event_type\") == \"player_possession\") &amp;\n        (pl.col(\"third_start\") != \"attacking_third\") &amp;\n        (pl.col(\"third_end\") == \"attacking_third\")\n    )\n</code></pre>"},{"location":"methodology/#part-3-data-driven-weight-calibration","title":"Part 3: Data-Driven Weight Calibration","text":""},{"location":"methodology/#skillcorner-a-league-statistics","title":"SkillCorner A-League Statistics","text":"<pre><code>\"\"\"Compute correlations to calibrate weights.\"\"\"\nimport polars as pl\nimport numpy as np\n\n# Load A-League data\nfrom src.data.loader import load_all_events, add_team_names\nfrom src.analysis.entries import detect_entries, classify_entries\nfrom src.analysis.profiles import build_player_profiles, filter_profiles\n\nevents = load_all_events()\nevents = add_team_names(events)\nentries = detect_entries(events)\nentries = classify_entries(entries)\nprofiles = build_player_profiles(entries)\nprofiles = filter_profiles(profiles, min_entries=3)\n\n# Compute correlations with danger_rate\nfeatures = ['avg_separation', 'central_pct', 'half_space_pct',\n            'avg_entry_speed', 'avg_passing_options', 'carry_pct']\n\ndanger = profiles['danger_rate'].to_numpy()\nfor feat in features:\n    vals = profiles[feat].to_numpy()\n    corr = np.corrcoef(danger, vals)[0, 1]\n    print(f'{feat}: r={corr:+.3f}')\n</code></pre>"},{"location":"methodology/#correlation-results-a-league-202425","title":"Correlation Results (A-League 2024/25)","text":"Feature Correlation with danger_rate Weight Decision <code>avg_entry_speed</code> r=+0.340 20% - strongest predictor <code>central_pct</code> r=+0.295 18% - central is dangerous <code>quick_break_pct</code> r=+0.262 10% - counter-attack threat <code>avg_separation</code> r=+0.221 15% - intelligent movement <code>avg_defensive_line_dist</code> r=-0.259 12% - closer to goal <code>half_space_pct</code> r=-0.012 3% - no correlation! <code>avg_passing_options</code> r=-0.050 2% - no correlation! <code>carry_pct</code> mean=98.8% 1% - no variance!"},{"location":"methodology/#key-insight-carry_pct-is-useless","title":"Key Insight: carry_pct is Useless","text":"<pre><code>carry_pct: mean=98.82%, std=4.60%\n</code></pre> <p>Almost ALL final third entries in A-League are carries. This feature has virtually no discriminating power and should be weighted near-zero.</p>"},{"location":"methodology/#part-4-final-weight-configuration","title":"Part 4: Final Weight Configuration","text":""},{"location":"methodology/#weights-justified-by-data-archetype","title":"Weights Justified by Data + Archetype","text":"<pre><code>FEATURE_WEIGHTS = {\n    # DATA-DRIVEN: Strongest correlations with danger_rate\n    \"avg_entry_speed\": 0.20,          # r=+0.340 strongest predictor\n    \"central_pct\": 0.18,              # r=+0.295 central = dangerous\n    \"avg_separation\": 0.15,           # r=+0.221 intelligent movement\n    \"avg_defensive_line_dist\": 0.12,  # r=-0.259 closer to goal\n\n    # ARCHETYPE-DRIVEN: From StatsBomb profile\n    \"danger_rate\": 0.15,              # 20% conversion (clinical)\n    \"quick_break_pct\": 0.10,          # r=+0.262 counter-attack\n\n    # LOW/ZERO CORRELATION - reduced\n    \"half_space_pct\": 0.03,           # r=-0.012 useless\n    \"avg_passing_options\": 0.02,      # r=-0.050 useless\n    \"avg_teammates_ahead\": 0.03,      # r=-0.240 negative\n\n    # NEAR-ZERO VARIANCE - effectively useless\n    \"carry_pct\": 0.01,                # 98.8% mean, no variance\n    \"goal_rate\": 0.00,                # Too sparse\n}\n</code></pre>"},{"location":"methodology/#part-5-similarity-computation","title":"Part 5: Similarity Computation","text":""},{"location":"methodology/#weighted-cosine-similarity","title":"Weighted Cosine Similarity","text":"<pre><code>def compute_similarity(player_profile: dict, target_profile: dict, weights: dict) -&gt; float:\n    \"\"\"\n    Compute weighted cosine similarity between player and target.\n\n    1. Z-score normalize all features\n    2. Apply weights to both vectors\n    3. Compute cosine similarity\n    4. Scale to 0-100\n    \"\"\"\n    features = list(weights.keys())\n\n    # Normalize\n    player_vec = normalize(player_profile, features)\n    target_vec = normalize(target_profile, features)\n\n    # Weight\n    player_weighted = player_vec * weights\n    target_weighted = target_vec * weights\n\n    # Cosine similarity\n    similarity = dot(player_weighted, target_weighted) / (norm(player_weighted) * norm(target_weighted))\n\n    # Scale to 0-100\n    return (similarity + 1) * 50\n</code></pre>"},{"location":"methodology/#target-profile-definition","title":"Target Profile Definition","text":"<p>For features where higher is better (direction=1), target = 90th percentile. For features where lower is better (direction=-1), target = 10th percentile.</p>"},{"location":"methodology/#part-6-ml-models-for-weight-calibration","title":"Part 6: ML Models for Weight Calibration","text":""},{"location":"methodology/#gradientboosting-models-by-position","title":"GradientBoosting Models by Position","text":"<p>I trained GradientBoosting classifiers for each position type to empirically determine feature importance:</p> Position Target Variable AUC Events Forwards lead_to_shot 0.656 \u00b1 0.027 245 entries Defenders stop_possession_danger 0.845 \u00b1 0.016 8,911 engagements Goalkeepers pass_success 0.993 \u00b1 0.011 497 distributions <pre><code>from sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.model_selection import cross_val_score\n\nmodel = GradientBoostingClassifier(n_estimators=100, max_depth=4)\ncv_scores = cross_val_score(model, X, y, cv=5, scoring='roc_auc')\n</code></pre>"},{"location":"methodology/#forward-feature-importances-auc-0656","title":"Forward Feature Importances (AUC 0.656)","text":"Feature ML Importance Final Weight <code>separation_end</code> 16.2% 23% <code>speed_avg</code> 11.8% 17% <code>delta_to_last_defensive_line</code> 10.3% 15% <code>entry_zone_num</code> 8.5% 12% <code>n_passing_options_ahead</code> 1.2% 2%"},{"location":"methodology/#defender-feature-importances-auc-0845","title":"Defender Feature Importances (AUC 0.845)","text":"Feature ML Importance Final Weight <code>x_start</code> (position) 52.9% (location) <code>speed_avg</code> 17.4% (engagement speed) <code>interplayer_distance_start</code> 11.4% 17% <code>engagement_type_num</code> 2.7% 4% <code>goal_side_start</code> 1.9% 3%"},{"location":"methodology/#goalkeeper-feature-importances-auc-0993","title":"Goalkeeper Feature Importances (AUC 0.993)","text":"Feature ML Importance Notes <code>pass_distance</code> 98.6% Shorter = more success Other features &lt;2% Style differentiators <p>The goalkeeper model achieves near-perfect AUC because pass distance strongly predicts success. For archetype comparison, we balance this with style differentiators (long/short pass preference).</p>"},{"location":"methodology/#key-insight-why-key-passes-dont-predict-danger","title":"Key Insight: Why Key Passes Don't Predict Danger","text":"<p>StatsBomb key passes (event-level: pass leads to shot) \u2260 SkillCorner passing options (state-level: options available at entry).</p> <ul> <li>StatsBomb: Measures EXECUTION - did this pass create a chance?</li> <li>SkillCorner: Measures POTENTIAL - how many teammates ahead?</li> </ul> <p>Alvarez's key pass ability is about decision-making and execution, which tracking data can't directly capture. We compensate by weighting <code>danger_rate</code> higher (18%) - entries leading to shots is the closest proxy.</p>"},{"location":"methodology/#summary","title":"Summary","text":"Step Data Source Method 1. Define archetype StatsBomb (WC/Copa) Extract Alvarez event metrics 2. Map to tracking Conceptual StatsBomb events \u2192 SkillCorner tracking 3. Calibrate weights ML (GradientBoosting) Feature importance on A-League data 4. Compute similarity Combined Weighted cosine similarity <p>This hybrid approach combines: - Domain knowledge (Alvarez archetype from StatsBomb) - ML validation (GradientBoosting feature importance) - Correlation analysis (A-League data patterns)</p>"},{"location":"methodology/#part-7-player-archetype-selection-criteria","title":"Part 7: Player Archetype Selection Criteria","text":""},{"location":"methodology/#why-these-10-players","title":"Why These 10 Players?","text":"<p>The archetypes were selected based on three key criteria:</p> <ol> <li>Data Availability: Players must have sufficient events in StatsBomb free data (World Cup 2022) for reliable statistics</li> <li>Realistic Comparisons: Avoiding generational talents (Messi, Mbappe) whose profiles are unrealistic targets for league-level scouting</li> <li>Style Diversity: Covering different playing styles to demonstrate the tool's versatility</li> </ol>"},{"location":"methodology/#selection-process","title":"Selection Process","text":"<p>We analysed World Cup 2022 data to find players with: - Forwards: 5+ shots (sufficient sample for conversion rates) - Defenders: 200+ passes, 10+ clearances/interceptions - Goalkeepers: 10+ saves across multiple matches</p>"},{"location":"methodology/#available-archetypes","title":"Available Archetypes","text":""},{"location":"methodology/#forwards-6-players","title":"Forwards (6 players)","text":"Player Country Shots Goals Conv% Dribbles Style Alvarez ARG 11 4 36.4% 0% Movement-focused, intelligent runs Giroud FRA 17 4 23.5% 0% Target man, hold-up play, aerial threat Kane ENG 12 2 16.7% 43% Complete forward, link-up play Lewandowski POL 12 2 16.7% 40% Clinical poacher, box presence Rashford ENG 11 3 27.3% 60% Pace, direct dribbling, wide threat En-Nesyri MAR 11 2 18.2% 67% Physical forward, aerial presence"},{"location":"methodology/#defenders-2-players","title":"Defenders (2 players)","text":"Player Country Passes Pass% Clearances Interceptions Style Gvardiol CRO 510 91% 43 14 Ball-playing CB, progressive carrier Romero ARG 372 89% 26 9 Aggressive CB, strong tackler"},{"location":"methodology/#goalkeepers-2-players","title":"Goalkeepers (2 players)","text":"Player Country Matches Saves Style Lloris FRA 6 94 Experienced captain, commanding presence Livakovic CRO 7 103 Penalty hero, high volume saves"},{"location":"methodology/#why-not-messimbappe","title":"Why Not Messi/Mbappe?","text":"<p>While Messi and Mbappe have extensive data in World Cup 2022, they represent outlier profiles: - Messi: 72% dribble success, 26% conversion - unrealistic target for most leagues - Mbappe: 60% dribble success, 28% conversion - pace/skill combination rare at any level</p> <p>Using these as archetypes would yield few meaningful matches in A-League or similar leagues. The selected players represent achievable excellence - world-class but not once-in-a-generation.</p>"},{"location":"methodology/#part-8-using-this-tool-with-other-skillcorner-data","title":"Part 8: Using This Tool with Other SkillCorner Data","text":""},{"location":"methodology/#architecture-overview","title":"Architecture Overview","text":"<p>The tool is designed to work with any SkillCorner tracking data, not just A-League:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  YOUR DATA                                                       \u2502\n\u2502  - SkillCorner dynamic_events.csv                               \u2502\n\u2502  - Any league/competition supported                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n                              \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  src/data/loader.py                                              \u2502\n\u2502  - load_events(match_id) or load_all_events()                   \u2502\n\u2502  - Returns Polars DataFrame with tracking metrics                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n                              \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  src/analysis/                                                   \u2502\n\u2502  - entries.py: detect_entries(), classify_entries()            \u2502\n\u2502  - profiles.py: build_player_profiles()                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n                              \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  src/core/                                                       \u2502\n\u2502  - archetype.py: Archetype.from_statsbomb(\"alvarez\")            \u2502\n\u2502  - similarity.py: SimilarityEngine(archetype).fit(profiles)    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n                              \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  RESULTS: Ranked players by similarity to archetype             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"methodology/#loading-your-own-skillcorner-data","title":"Loading Your Own SkillCorner Data","text":""},{"location":"methodology/#option-1-use-skillcorner-open-data-other-matches","title":"Option 1: Use SkillCorner Open Data (other matches)","text":"<pre><code>from src.data.loader import load_events\n\n# Load any match from SkillCorner open data\n# See: github.com/SkillCorner/opendata for available match IDs\nevents = load_events(match_id=2017461)\n</code></pre>"},{"location":"methodology/#option-2-use-local-csv-files","title":"Option 2: Use Local CSV Files","text":"<pre><code>import polars as pl\n\n# Load your own SkillCorner dynamic_events.csv\nevents = pl.read_csv(\"path/to/your_dynamic_events.csv\")\n\n# Ensure required columns exist:\nrequired = [\"event_type\", \"player_id\", \"third_start\", \"third_end\",\n            \"speed_avg\", \"separation_end\", \"lead_to_shot\"]\n</code></pre>"},{"location":"methodology/#option-3-use-kloppy-for-any-skillcorner-data","title":"Option 3: Use kloppy for Any SkillCorner Data","text":"<pre><code>from kloppy import skillcorner\n\n# Load tracking data with kloppy\ndataset = skillcorner.load(\n    raw_data=\"path/to/match_data.json\",\n    metadata=\"path/to/match_metadata.json\"\n)\n\n# Convert to DataFrame\ndf = dataset.to_df()\n</code></pre>"},{"location":"methodology/#running-similarity-analysis","title":"Running Similarity Analysis","text":"<pre><code>from src.analysis.entries import detect_entries, classify_entries\nfrom src.analysis.profiles import build_player_profiles, filter_profiles\nfrom src.core.archetype import Archetype\nfrom src.core.similarity import SimilarityEngine\n\n# 1. Process your events\nentries = detect_entries(your_events)\nentries = classify_entries(entries)\n\n# 2. Build player profiles\nprofiles = build_player_profiles(entries)\nprofiles = filter_profiles(profiles, min_entries=3)\n\n# 3. Load any archetype\narchetype = Archetype.from_statsbomb(\"kane\")  # or giroud, lewandowski, etc.\n\n# 4. Run similarity analysis\nengine = SimilarityEngine(archetype)\nengine.fit(profiles)\nresults = engine.rank(top_n=10)\n\nprint(results)\n</code></pre>"},{"location":"methodology/#adding-custom-archetypes","title":"Adding Custom Archetypes","text":"<p>You can create custom archetypes without StatsBomb data:</p> <pre><code>from src.core.archetype import Archetype\n\n# Create a custom archetype\npressing_forward = Archetype.custom(\n    name=\"pressing_forward\",\n    description=\"High-energy forward who presses from the front\"\n)\n\n# Set target profile (0-100 scale)\npressing_forward.set_feature(\"avg_entry_speed\", target=85, weight=0.25, direction=1)\npressing_forward.set_feature(\"danger_rate\", target=60, weight=0.20, direction=1)\npressing_forward.set_feature(\"avg_separation\", target=70, weight=0.20, direction=1)\npressing_forward.set_feature(\"central_pct\", target=80, weight=0.15, direction=1)\npressing_forward.set_feature(\"carry_pct\", target=30, weight=0.10, direction=1)\npressing_forward.set_feature(\"quick_break_pct\", target=70, weight=0.10, direction=1)\n\n# Use with SimilarityEngine\nengine = SimilarityEngine(pressing_forward)\nengine.fit(profiles)\n</code></pre>"},{"location":"methodology/#extending-to-new-leagues","title":"Extending to New Leagues","text":"<p>To use with a new league's SkillCorner data:</p> <ol> <li>Obtain SkillCorner data for your league (via SkillCorner API or open data)</li> <li>Load events using <code>load_events()</code> or custom loader</li> <li>Run the pipeline - entries \u2192 profiles \u2192 similarity</li> <li>Interpret results considering league context</li> </ol> <p>The ML-calibrated weights (separation: 23%, danger_rate: 18%, etc.) were derived from A-League data but should generalise reasonably to other leagues with similar playing styles.</p>"},{"location":"methodology/#part-9-adding-new-players-to-the-registry","title":"Part 9: Adding New Players to the Registry","text":"<p>To add a new player archetype from StatsBomb data:</p>"},{"location":"methodology/#step-1-find-the-player-in-statsbomb","title":"Step 1: Find the Player in StatsBomb","text":"<pre><code>from statsbombpy import sb\n\n# Check available competitions\ncomps = sb.competitions()\nprint(comps[['competition_id', 'season_name', 'competition_name']])\n\n# World Cup 2022 = competition_id: 43, season_id: 106\nmatches = sb.matches(competition_id=43, season_id=106)\n\n# Get events and find player name\nevents = sb.events(match_id=matches['match_id'].iloc[0])\nprint(events['player'].unique())\n</code></pre>"},{"location":"methodology/#step-2-add-to-registry","title":"Step 2: Add to Registry","text":"<p>Edit <code>src/statsbomb/registry.py</code>:</p> <pre><code>PLAYER_REGISTRY = {\n    # ... existing players ...\n\n    \"your_player\": {\n        \"player_name\": \"Exact Name From StatsBomb\",  # Must match exactly!\n        \"display_name\": \"Display Name\",\n        \"position\": \"Forward\",  # or \"Defender\", \"Goalkeeper\"\n        \"nationality\": \"Country\",\n        \"style\": \"Brief style description\",\n        \"competitions\": [\n            (43, 106, \"FIFA World Cup 2022\"),  # (competition_id, season_id, name)\n        ],\n    },\n}\n</code></pre>"},{"location":"methodology/#step-3-test","title":"Step 3: Test","text":"<pre><code>from src.core.archetype import Archetype\n\narch = Archetype.from_statsbomb(\"your_player\")\nprint(arch.description)  # Should show computed stats\n</code></pre>"},{"location":"methodology/#part-10-ai-powered-scouting-insights","title":"Part 10: AI-Powered Scouting Insights","text":""},{"location":"methodology/#overview_1","title":"Overview","text":"<p>The tool includes optional AI-generated scouting recommendations using GitHub Models API (Phi-4 or GPT-4o-mini). These insights contextualise the similarity rankings with human-readable analysis.</p>"},{"location":"methodology/#how-it-works","title":"How It Works","text":"<p>The AI receives a position-aware prompt containing:</p> <ol> <li>Position context: forward, defender, or goalkeeper</li> <li>Archetype description: from StatsBomb profile</li> <li>ML model confidence: AUC score indicating ranking reliability</li> <li>Top candidates: player names, ages, teams, and key metrics</li> <li>Dataset averages: for comparison context</li> <li>Position criteria: what makes a great player in this position</li> </ol>"},{"location":"methodology/#position-specific-metrics","title":"Position-Specific Metrics","text":"<p>Different metrics matter for different positions:</p> Position Key Metrics ML AUC Forward danger_rate, central_pct, separation, entry_speed 0.656 Defender stop_danger_rate, pressing_rate, goal_side_rate 0.845 Goalkeeper pass_success_rate, pass_distance, long_pass_pct 0.993"},{"location":"methodology/#example-usage","title":"Example Usage","text":"<pre><code>from src.utils.ai_insights import generate_similarity_insight, has_valid_token\n\nif has_valid_token():\n    insight = generate_similarity_insight(\n        ranked_players,\n        archetype,\n        top_n=5,\n        position_type=\"forward\",\n    )\n    print(insight)\n</code></pre>"},{"location":"methodology/#sample-output","title":"Sample Output","text":"<p>For the Alvarez archetype:</p> <p>Z. Clough emerges as the closest match with an 88.7% similarity. His 50% danger rate mirrors Alvarez's clinical finishing, though with fewer entries.</p> <p>The key difference lies in movement patterns. While Clough shows good separation (8.2m), his central percentage is lower than target, suggesting he drifts wide.</p> <p>For development potential, T. Payne at 22 offers interesting upside despite a lower current similarity.</p>"},{"location":"methodology/#configuration","title":"Configuration","text":"<p>Available in <code>src/utils/ai_insights.py</code>:</p> <pre><code># position-specific metric configs\nPOSITION_METRICS = {\n    \"forward\": {\n        \"metrics\": [\"danger_rate\", \"central_pct\", \"avg_separation\", ...],\n        \"count_field\": \"total_entries\",\n        \"auc\": 0.656,\n        \"criteria\": \"Forwards are valued for creating danger...\",\n    },\n    # defender and goalkeeper configs...\n}\n</code></pre>"},{"location":"methodology/#privacy-considerations","title":"Privacy Considerations","text":"<p>Only aggregated metrics and player names are sent to the AI. No raw tracking coordinates or identifiers beyond public player names are transmitted.</p>"},{"location":"api/archetype/","title":"Archetype","text":""},{"location":"api/archetype/#src.core.archetype.Archetype","title":"<code>src.core.archetype.Archetype</code>  <code>dataclass</code>","text":"<p>Define a player archetype for similarity matching.</p> Source code in <code>src/core/archetype.py</code> <pre><code>@dataclass\nclass Archetype:\n    \"\"\"Define a player archetype for similarity matching.\"\"\"\n\n    name: str\n    description: str = \"\"\n    target_profile: dict[str, float] = field(default_factory=dict)\n    weights: dict[str, float] = field(default_factory=dict)\n    directions: dict[str, int] = field(default_factory=dict)\n\n    def set_target(self, feature: str, value: float) -&gt; Archetype:\n        self.target_profile[feature] = value\n        return self\n\n    def set_weight(self, feature: str, weight: float) -&gt; Archetype:\n        self.weights[feature] = weight\n        return self\n\n    def set_direction(self, feature: str, direction: int) -&gt; Archetype:\n        self.directions[feature] = direction\n        return self\n\n    def set_feature(self, feature: str, target: float, weight: float, direction: int = 1) -&gt; Archetype:\n        self.target_profile[feature] = target\n        self.weights[feature] = weight\n        self.directions[feature] = direction\n        return self\n\n    def get_features(self) -&gt; list[str]:\n        return [f for f, w in self.weights.items() if w &gt; 0]\n\n    def validate(self) -&gt; list[str]:\n        warnings = []\n        weight_sum = sum(self.weights.values())\n        if abs(weight_sum - 1.0) &gt; 0.1:\n            warnings.append(f\"Weights sum to {weight_sum:.2f}, expected ~1.0\")\n        return warnings\n\n    @classmethod\n    def from_statsbomb(cls, player_key: str, verbose: bool = False) -&gt; Archetype:\n        \"\"\"Create archetype from StatsBomb event data.\n\n        Loads real player events from StatsBomb free data, calculates\n        statistics, and builds a data-driven target profile.\n\n        Args:\n            player_key: Player identifier (e.g., \"alvarez\", \"messi\", \"mbappe\")\n            verbose: If True, print progress when loading data\n\n        Returns:\n            Archetype with target profile computed from actual player stats\n\n        Raises:\n            KeyError: If player_key not found in registry\n            ValueError: If no events found for the player\n\n        Example:\n            &gt;&gt;&gt; archetype = Archetype.from_statsbomb(\"alvarez\")\n            &gt;&gt;&gt; print(archetype.description)\n            # Shows actual World Cup 2022 stats\n        \"\"\"\n        from src.core.archetype_factory import ArchetypeFactory\n        factory = ArchetypeFactory(verbose=verbose)\n        return factory.build(player_key)\n\n    @classmethod\n    def list_available(cls) -&gt; list[str]:\n        \"\"\"List available player archetypes from StatsBomb data.\n\n        Returns:\n            List of player keys that can be used with from_statsbomb()\n\n        Example:\n            &gt;&gt;&gt; Archetype.list_available()\n            ['alvarez', 'messi', 'mbappe']\n        \"\"\"\n        from src.core.archetype_factory import ArchetypeFactory\n        return ArchetypeFactory().list_available()\n\n    @classmethod\n    def alvarez(cls) -&gt; Archetype:\n        \"\"\"Create pre-built Julian Alvarez archetype (legacy/fallback).\n\n        Note: Prefer using Archetype.from_statsbomb(\"alvarez\") for\n        data-driven archetype computed from actual StatsBomb events.\n\n        This method provides a fallback with hardcoded values based on\n        manual research, useful when StatsBomb data is unavailable.\n        \"\"\"\n        archetype = cls(\n            name=\"alvarez\",\n            description=\"Julian Alvarez: intelligent movement, spatial awareness, clinical finishing.\",\n        )\n        archetype.target_profile = {\n            \"avg_separation\": 85, \"danger_rate\": 90, \"central_pct\": 75,\n            \"avg_entry_speed\": 70, \"half_space_pct\": 60, \"avg_passing_options\": 65, \"carry_pct\": 40,\n        }\n        archetype.weights = {\n            \"avg_separation\": 0.23, \"avg_entry_speed\": 0.17, \"avg_defensive_line_dist\": 0.15,\n            \"central_pct\": 0.12, \"danger_rate\": 0.18, \"quick_break_pct\": 0.05,\n            \"avg_teammates_ahead\": 0.05, \"half_space_pct\": 0.02, \"avg_passing_options\": 0.02,\n            \"carry_pct\": 0.00, \"avg_distance\": 0.01, \"goal_rate\": 0.00,\n        }\n        archetype.directions = {\n            \"avg_entry_speed\": 1, \"avg_distance\": 1, \"total_entries\": 0, \"avg_separation\": 1,\n            \"avg_defensive_line_dist\": -1, \"central_pct\": 1, \"half_space_pct\": 1, \"carry_pct\": 1,\n            \"avg_passing_options\": 1, \"avg_teammates_ahead\": 1, \"danger_rate\": 1, \"goal_rate\": 1, \"quick_break_pct\": 1,\n        }\n        return archetype\n\n    @classmethod\n    def custom(cls, name: str, description: str = \"\") -&gt; Archetype:\n        \"\"\"Create a custom archetype with empty profile.\n\n        Use set_feature() to define the target profile.\n\n        Args:\n            name: Archetype identifier\n            description: Human-readable description\n\n        Example:\n            &gt;&gt;&gt; pressing = Archetype.custom(\"pressing_forward\", \"High-energy forward\")\n            &gt;&gt;&gt; pressing.set_feature(\"avg_entry_speed\", target=85, weight=0.25, direction=1)\n        \"\"\"\n        return cls(name=name, description=description)\n</code></pre>"},{"location":"api/archetype/#src.core.archetype.Archetype.from_statsbomb","title":"<code>from_statsbomb(player_key, verbose=False)</code>  <code>classmethod</code>","text":"<p>Create archetype from StatsBomb event data.</p> <p>Loads real player events from StatsBomb free data, calculates statistics, and builds a data-driven target profile.</p> <p>Parameters:</p> Name Type Description Default <code>player_key</code> <code>str</code> <p>Player identifier (e.g., \"alvarez\", \"messi\", \"mbappe\")</p> required <code>verbose</code> <code>bool</code> <p>If True, print progress when loading data</p> <code>False</code> <p>Returns:</p> Type Description <code>Archetype</code> <p>Archetype with target profile computed from actual player stats</p> <p>Raises:</p> Type Description <code>KeyError</code> <p>If player_key not found in registry</p> <code>ValueError</code> <p>If no events found for the player</p> Example <p>archetype = Archetype.from_statsbomb(\"alvarez\") print(archetype.description)</p> Source code in <code>src/core/archetype.py</code> <pre><code>@classmethod\ndef from_statsbomb(cls, player_key: str, verbose: bool = False) -&gt; Archetype:\n    \"\"\"Create archetype from StatsBomb event data.\n\n    Loads real player events from StatsBomb free data, calculates\n    statistics, and builds a data-driven target profile.\n\n    Args:\n        player_key: Player identifier (e.g., \"alvarez\", \"messi\", \"mbappe\")\n        verbose: If True, print progress when loading data\n\n    Returns:\n        Archetype with target profile computed from actual player stats\n\n    Raises:\n        KeyError: If player_key not found in registry\n        ValueError: If no events found for the player\n\n    Example:\n        &gt;&gt;&gt; archetype = Archetype.from_statsbomb(\"alvarez\")\n        &gt;&gt;&gt; print(archetype.description)\n        # Shows actual World Cup 2022 stats\n    \"\"\"\n    from src.core.archetype_factory import ArchetypeFactory\n    factory = ArchetypeFactory(verbose=verbose)\n    return factory.build(player_key)\n</code></pre>"},{"location":"api/archetype/#src.core.archetype.Archetype.from_statsbomb--shows-actual-world-cup-2022-stats","title":"Shows actual World Cup 2022 stats","text":""},{"location":"api/archetype/#src.core.archetype.Archetype.list_available","title":"<code>list_available()</code>  <code>classmethod</code>","text":"<p>List available player archetypes from StatsBomb data.</p> <p>Returns:</p> Type Description <code>list[str]</code> <p>List of player keys that can be used with from_statsbomb()</p> Example <p>Archetype.list_available() ['alvarez', 'messi', 'mbappe']</p> Source code in <code>src/core/archetype.py</code> <pre><code>@classmethod\ndef list_available(cls) -&gt; list[str]:\n    \"\"\"List available player archetypes from StatsBomb data.\n\n    Returns:\n        List of player keys that can be used with from_statsbomb()\n\n    Example:\n        &gt;&gt;&gt; Archetype.list_available()\n        ['alvarez', 'messi', 'mbappe']\n    \"\"\"\n    from src.core.archetype_factory import ArchetypeFactory\n    return ArchetypeFactory().list_available()\n</code></pre>"},{"location":"api/archetype/#src.core.archetype.Archetype.alvarez","title":"<code>alvarez()</code>  <code>classmethod</code>","text":"<p>Create pre-built Julian Alvarez archetype (legacy/fallback).</p> <p>Note: Prefer using Archetype.from_statsbomb(\"alvarez\") for data-driven archetype computed from actual StatsBomb events.</p> <p>This method provides a fallback with hardcoded values based on manual research, useful when StatsBomb data is unavailable.</p> Source code in <code>src/core/archetype.py</code> <pre><code>@classmethod\ndef alvarez(cls) -&gt; Archetype:\n    \"\"\"Create pre-built Julian Alvarez archetype (legacy/fallback).\n\n    Note: Prefer using Archetype.from_statsbomb(\"alvarez\") for\n    data-driven archetype computed from actual StatsBomb events.\n\n    This method provides a fallback with hardcoded values based on\n    manual research, useful when StatsBomb data is unavailable.\n    \"\"\"\n    archetype = cls(\n        name=\"alvarez\",\n        description=\"Julian Alvarez: intelligent movement, spatial awareness, clinical finishing.\",\n    )\n    archetype.target_profile = {\n        \"avg_separation\": 85, \"danger_rate\": 90, \"central_pct\": 75,\n        \"avg_entry_speed\": 70, \"half_space_pct\": 60, \"avg_passing_options\": 65, \"carry_pct\": 40,\n    }\n    archetype.weights = {\n        \"avg_separation\": 0.23, \"avg_entry_speed\": 0.17, \"avg_defensive_line_dist\": 0.15,\n        \"central_pct\": 0.12, \"danger_rate\": 0.18, \"quick_break_pct\": 0.05,\n        \"avg_teammates_ahead\": 0.05, \"half_space_pct\": 0.02, \"avg_passing_options\": 0.02,\n        \"carry_pct\": 0.00, \"avg_distance\": 0.01, \"goal_rate\": 0.00,\n    }\n    archetype.directions = {\n        \"avg_entry_speed\": 1, \"avg_distance\": 1, \"total_entries\": 0, \"avg_separation\": 1,\n        \"avg_defensive_line_dist\": -1, \"central_pct\": 1, \"half_space_pct\": 1, \"carry_pct\": 1,\n        \"avg_passing_options\": 1, \"avg_teammates_ahead\": 1, \"danger_rate\": 1, \"goal_rate\": 1, \"quick_break_pct\": 1,\n    }\n    return archetype\n</code></pre>"},{"location":"api/archetype/#src.core.archetype.Archetype.custom","title":"<code>custom(name, description='')</code>  <code>classmethod</code>","text":"<p>Create a custom archetype with empty profile.</p> <p>Use set_feature() to define the target profile.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Archetype identifier</p> required <code>description</code> <code>str</code> <p>Human-readable description</p> <code>''</code> Example <p>pressing = Archetype.custom(\"pressing_forward\", \"High-energy forward\") pressing.set_feature(\"avg_entry_speed\", target=85, weight=0.25, direction=1)</p> Source code in <code>src/core/archetype.py</code> <pre><code>@classmethod\ndef custom(cls, name: str, description: str = \"\") -&gt; Archetype:\n    \"\"\"Create a custom archetype with empty profile.\n\n    Use set_feature() to define the target profile.\n\n    Args:\n        name: Archetype identifier\n        description: Human-readable description\n\n    Example:\n        &gt;&gt;&gt; pressing = Archetype.custom(\"pressing_forward\", \"High-energy forward\")\n        &gt;&gt;&gt; pressing.set_feature(\"avg_entry_speed\", target=85, weight=0.25, direction=1)\n    \"\"\"\n    return cls(name=name, description=description)\n</code></pre>"},{"location":"api/profiler/","title":"PlayerProfiler","text":""},{"location":"api/profiler/#src.core.profiler.PlayerProfiler","title":"<code>src.core.profiler.PlayerProfiler</code>","text":"<p>Build player profiles from SkillCorner tracking data.</p> Source code in <code>src/core/profiler.py</code> <pre><code>class PlayerProfiler:\n    \"\"\"Build player profiles from SkillCorner tracking data.\"\"\"\n\n    def __init__(self, min_entries: int = 3):\n        self.min_entries = min_entries\n        self.events: pl.DataFrame | None = None\n        self.entries: pl.DataFrame | None = None\n        self.profiles: pl.DataFrame | None = None\n\n    def load_data(self, match_ids: list[int] | None = None) -&gt; PlayerProfiler:\n        from src.data.loader import load_all_events, add_team_names\n        self.events = load_all_events(match_ids=match_ids)\n        self.events = add_team_names(self.events)\n        return self\n\n    def load_from_dataframe(self, events: pl.DataFrame) -&gt; PlayerProfiler:\n        self.events = events\n        return self\n\n    def detect_entries(self) -&gt; PlayerProfiler:\n        if self.events is None:\n            raise ValueError(\"No events loaded. Call load_data() first.\")\n        from src.analysis.entries import detect_entries, classify_entries\n        self.entries = detect_entries(self.events)\n        self.entries = classify_entries(self.entries)\n        return self\n\n    def build_profiles(self) -&gt; PlayerProfiler:\n        if self.entries is None:\n            raise ValueError(\"No entries detected. Call detect_entries() first.\")\n        from src.analysis.profiles import build_player_profiles, filter_profiles\n        self.profiles = build_player_profiles(self.entries)\n        self.profiles = filter_profiles(self.profiles, min_entries=self.min_entries)\n        return self\n\n    def add_ages(self, ages: dict[str, int] | None = None) -&gt; PlayerProfiler:\n        if self.profiles is None:\n            raise ValueError(\"No profiles built. Call build_profiles() first.\")\n        if ages is None:\n            from src.data.player_ages import add_ages_to_profiles\n            self.profiles = add_ages_to_profiles(self.profiles)\n        else:\n            age_data = [(name, age) for name, age in ages.items()]\n            age_df = pl.DataFrame(age_data, schema=[\"player_name\", \"age\"], orient=\"row\")\n            self.profiles = self.profiles.join(age_df, on=\"player_name\", how=\"left\")\n        return self\n\n    def get_summary(self) -&gt; dict:\n        return {\n            \"events_loaded\": len(self.events) if self.events is not None else 0,\n            \"entries_detected\": len(self.entries) if self.entries is not None else 0,\n            \"profiles_built\": len(self.profiles) if self.profiles is not None else 0,\n        }\n\n    def get_player_entries(self, player_name: str) -&gt; pl.DataFrame | None:\n        if self.entries is None:\n            return None\n        result = self.entries.filter(pl.col(\"player_name\") == player_name)\n        return result if len(result) &gt; 0 else None\n\n    def get_player_profile(self, player_name: str) -&gt; dict | None:\n        if self.profiles is None:\n            return None\n        result = self.profiles.filter(pl.col(\"player_name\") == player_name)\n        return result.to_dicts()[0] if len(result) &gt; 0 else None\n\n    @classmethod\n    def from_skillcorner(cls, match_ids: list[int] | None = None, min_entries: int = 3) -&gt; PlayerProfiler:\n        profiler = cls(min_entries=min_entries)\n        profiler.load_data(match_ids=match_ids)\n        profiler.detect_entries()\n        profiler.build_profiles()\n        profiler.add_ages()\n        return profiler\n</code></pre>"},{"location":"api/report/","title":"ScoutingReport","text":""},{"location":"api/report/#src.core.report.ScoutingReport","title":"<code>src.core.report.ScoutingReport</code>","text":"<p>Generate AI-powered scouting reports.</p> Source code in <code>src/core/report.py</code> <pre><code>class ScoutingReport:\n    \"\"\"Generate AI-powered scouting reports.\"\"\"\n\n    AVAILABLE_MODELS = {\"phi-4\": \"microsoft/Phi-4\", \"gpt-4o-mini\": \"openai/gpt-4o-mini\"}\n    SYSTEM_PROMPT = \"You are a football scout writing player similarity reports. Use Australian English. Be practical and specific.\"\n\n    def __init__(self, engine: SimilarityEngine, model: str = \"phi-4\"):\n        self.engine = engine\n        self.model = model\n        self._token: str | None = None\n\n    def set_token(self, token: str) -&gt; ScoutingReport:\n        self._token = token\n        os.environ[\"GITHUB_TOKEN\"] = token\n        return self\n\n    def _get_token(self) -&gt; str | None:\n        if self._token:\n            return self._token\n        token = os.environ.get(\"GITHUB_TOKEN\")\n        if token:\n            return token\n        token_path = Path(__file__).parent.parent.parent / \"github_token.txt\"\n        if token_path.exists():\n            return token_path.read_text().strip()\n        return None\n\n    def has_valid_token(self) -&gt; bool:\n        token = self._get_token()\n        return token is not None and len(token) &gt; 10\n\n    def _call_model(self, prompt: str, max_tokens: int = 300) -&gt; str:\n        token = self._get_token()\n        if not token:\n            return \"AI insights unavailable (no GitHub token provided)\"\n        import requests\n        try:\n            response = requests.post(\n                \"https://models.github.ai/inference/chat/completions\",\n                headers={\"Authorization\": f\"Bearer {token}\", \"Content-Type\": \"application/json\"},\n                json={\"model\": self.AVAILABLE_MODELS.get(self.model, \"microsoft/Phi-4\"),\n                      \"messages\": [{\"role\": \"system\", \"content\": self.SYSTEM_PROMPT}, {\"role\": \"user\", \"content\": prompt}],\n                      \"max_tokens\": max_tokens},\n                timeout=30,\n            )\n            response.raise_for_status()\n            return response.json()[\"choices\"][0][\"message\"][\"content\"]\n        except Exception as e:\n            return f\"AI unavailable: {str(e)}\"\n\n    def generate(self, top_n: int = 5) -&gt; str:\n        if self.engine.rankings is None:\n            self.engine.rank(top_n=top_n)\n        rankings = self.engine.rankings.head(top_n)\n        summaries = []\n        for row in rankings.to_dicts():\n            age = row.get(\"age\")\n            age_str = f\"Age {age}, \" if age else \"\"\n            summaries.append(f\"- {row.get('player_name', 'Unknown')} ({row.get('team_name', '')}): {age_str}Similarity {row.get('similarity_score', 0):.1f}%, Danger rate {row.get('danger_rate', 0):.1f}%\")\n        prompt = f\"Analyse these A-League players compared to the {self.engine.archetype.name.title()} archetype.\\n\\nTOP CANDIDATES:\\n\" + \"\\n\".join(summaries) + \"\\n\\nWrite 3-4 paragraphs. Make player names **bold**. Use Australian English.\"\n        return self._call_model(prompt, max_tokens=450)\n\n    def player_report(self, player_name: str) -&gt; str:\n        profile = next((r for r in self.engine.profiles.to_dicts() if r.get(\"player_name\") == player_name), {})\n        prompt = f\"Write a brief scouting report for {player_name} compared to the {self.engine.archetype.name} archetype. Danger Rate: {profile.get('danger_rate', 0):.1f}%, Separation: {profile.get('avg_separation', 0):.2f}m. Be specific. Australian English.\"\n        return self._call_model(prompt, max_tokens=250)\n</code></pre>"},{"location":"api/similarity/","title":"SimilarityEngine","text":""},{"location":"api/similarity/#src.core.similarity.SimilarityEngine","title":"<code>src.core.similarity.SimilarityEngine</code>","text":"<p>Compute similarity between player profiles and an archetype.</p> Source code in <code>src/core/similarity.py</code> <pre><code>class SimilarityEngine:\n    \"\"\"Compute similarity between player profiles and an archetype.\"\"\"\n\n    def __init__(self, archetype: Archetype):\n        self.archetype = archetype\n        self.profiles: pl.DataFrame | None = None\n        self.rankings: pl.DataFrame | None = None\n        self._stats: dict[str, dict[str, float]] = {}\n\n    def fit(self, profiles: pl.DataFrame) -&gt; SimilarityEngine:\n        self.profiles = profiles\n        self._compute_stats()\n        self._compute_scores()\n        return self\n\n    def _compute_stats(self) -&gt; None:\n        if self.profiles is None:\n            return\n        for feature in self._get_available_features():\n            if feature not in self.profiles.columns:\n                continue\n            mean_val = self.profiles[feature].mean() or 0.0\n            std_val = self.profiles[feature].std() or 1.0\n            self._stats[feature] = {\"mean\": mean_val, \"std\": std_val if std_val else 1.0}\n\n    def _get_available_features(self) -&gt; list[str]:\n        if self.profiles is None:\n            return []\n        return [f for f, w in self.archetype.weights.items() if w &gt; 0 and f in self.profiles.columns]\n\n    def _standardize_value(self, feature: str, value: float) -&gt; float:\n        if feature not in self._stats:\n            return 0.0\n        return (value - self._stats[feature][\"mean\"]) / self._stats[feature][\"std\"]\n\n    def _compute_target_profile(self) -&gt; dict[str, float]:\n        target_std = {}\n        for feature in self._get_available_features():\n            if feature in self.archetype.target_profile and self.profiles is not None:\n                pct = self.archetype.target_profile[feature] / 100.0\n                actual_target = self.profiles[feature].quantile(pct)\n                target_std[feature] = self._standardize_value(feature, actual_target)\n            else:\n                direction = self.archetype.directions.get(feature, 1)\n                if self.profiles is not None and feature in self.profiles.columns:\n                    target_val = self.profiles[feature].quantile(0.90 if direction == 1 else 0.10)\n                    target_std[feature] = self._standardize_value(feature, target_val)\n        return target_std\n\n    def _compute_scores(self) -&gt; None:\n        if self.profiles is None:\n            return\n        features = self._get_available_features()\n        target_std = self._compute_target_profile()\n        weights = self.archetype.weights\n\n        def compute_cosine_similarity(row: dict) -&gt; float:\n            player_vec, target_vec, weight_vec = [], [], []\n            for feature in features:\n                if feature not in row or row[feature] is None:\n                    continue\n                player_val = self._standardize_value(feature, row[feature])\n                if np.isnan(player_val):\n                    continue\n                player_vec.append(player_val)\n                target_vec.append(target_std.get(feature, 0.0))\n                weight_vec.append(weights.get(feature, 0.0))\n            if not player_vec:\n                return 0.0\n            player_arr, target_arr, weight_arr = np.array(player_vec), np.array(target_vec), np.array(weight_vec)\n            dot_product = np.dot(player_arr * weight_arr, target_arr * weight_arr)\n            player_norm, target_norm = np.linalg.norm(player_arr * weight_arr), np.linalg.norm(target_arr * weight_arr)\n            if player_norm == 0 or target_norm == 0:\n                return 0.0\n            return max(0, min(100, (dot_product / (player_norm * target_norm) + 1) * 50))\n\n        scores = [compute_cosine_similarity(row) for row in self.profiles.to_dicts()]\n        self.profiles = self.profiles.with_columns(pl.Series(\"similarity_score\", scores).round(1)).sort(\"similarity_score\", descending=True)\n\n    def score(self) -&gt; pl.DataFrame:\n        if self.profiles is None:\n            raise ValueError(\"Engine not fitted. Call fit() first.\")\n        return self.profiles\n\n    def rank(self, top_n: int = 10, min_entries: int | None = None) -&gt; pl.DataFrame:\n        if self.profiles is None:\n            raise ValueError(\"Engine not fitted. Call fit() first.\")\n        ranked = self.profiles.sort(\"similarity_score\", descending=True)\n        if min_entries is not None:\n            ranked = ranked.filter(pl.col(\"total_entries\") &gt;= min_entries)\n        self.rankings = ranked.with_row_index(\"rank\", offset=1).head(top_n)\n        return self.rankings\n\n    def explain(self, player_name: str) -&gt; dict:\n        if self.profiles is None:\n            raise ValueError(\"Engine not fitted.\")\n        player = self.profiles.filter(pl.col(\"player_name\") == player_name)\n        if len(player) == 0:\n            raise ValueError(f\"Player '{player_name}' not found\")\n        return {\"player_name\": player_name, \"similarity_score\": player.to_dicts()[0].get(\"similarity_score\", 0), \"archetype\": self.archetype.name}\n\n    def get_feature_importance(self) -&gt; list[dict]:\n        return sorted([{\"feature\": f, \"weight\": self.archetype.weights.get(f, 0)} for f in self._get_available_features()], key=lambda x: x[\"weight\"], reverse=True)\n</code></pre>"},{"location":"guide/archetypes/","title":"Defining Archetypes","text":"<p>An archetype defines the target player profile you want to match.</p>"},{"location":"guide/archetypes/#pre-built-archetypes-12-available","title":"Pre-built Archetypes (12 Available)","text":"<p>Load any of the 12 pre-built archetypes from StatsBomb World Cup 2022 data:</p> <pre><code>from src.core import Archetype\n\n# List all available archetypes\nprint(Archetype.list_available())\n# ['alvarez', 'giroud', 'kane', 'lewandowski', 'rashford', 'en_nesyri',\n#  'gvardiol', 'romero', 'hakimi', 'lloris', 'livakovic', 'bounou']\n\n# Load a specific archetype\narchetype = Archetype.from_statsbomb(\"alvarez\")\nprint(archetype.description)  # Shows actual World Cup 2022 stats\n</code></pre>"},{"location":"guide/archetypes/#by-position","title":"By Position","text":"Position Archetypes ML Model AUC Forwards alvarez, giroud, kane, lewandowski, rashford, en_nesyri 0.656 Defenders gvardiol, romero, hakimi 0.845 Goalkeepers lloris, livakovic, bounou 0.993"},{"location":"guide/archetypes/#examples","title":"Examples","text":"<pre><code># Forwards\narchetype = Archetype.from_statsbomb(\"alvarez\")    # Intelligent movement\narchetype = Archetype.from_statsbomb(\"giroud\")     # Target man\narchetype = Archetype.from_statsbomb(\"rashford\")   # Pace and dribbling\n\n# Defenders\narchetype = Archetype.from_statsbomb(\"gvardiol\")   # Ball-playing CB\narchetype = Archetype.from_statsbomb(\"hakimi\")     # Attacking wing-back\n\n# Goalkeepers\narchetype = Archetype.from_statsbomb(\"lloris\")     # Sweeper-keeper\n</code></pre>"},{"location":"guide/archetypes/#custom-archetypes","title":"Custom Archetypes","text":"<p>Create your own archetype for specific player types:</p> <pre><code>archetype = Archetype.custom(\"target_man\", \"Aerial presence forward\")\narchetype.set_feature(\"danger_rate\", target=80, weight=0.25, direction=1)\narchetype.set_feature(\"central_pct\", target=90, weight=0.20, direction=1)\n</code></pre>"},{"location":"guide/archetypes/#available-features","title":"Available Features","text":""},{"location":"guide/archetypes/#forward-features","title":"Forward Features","text":"Feature Description <code>avg_entry_speed</code> Mean speed during entries (m/s) <code>avg_separation</code> Distance from nearest defender (m) <code>central_pct</code> % of entries through central zone <code>danger_rate</code> % of entries leading to shots <code>carry_pct</code> % of entries via carries <code>quick_break_pct</code> % of entries in quick transitions"},{"location":"guide/archetypes/#defender-features","title":"Defender Features","text":"Feature Description <code>stop_danger_rate</code> % of engagements stopping dangerous attacks <code>avg_engagement_distance</code> Mean distance from goal during engagements <code>reduce_danger_rate</code> % of engagements reducing attack danger <code>beaten_by_possession_rate</code> % of times beaten by ball carrier"},{"location":"guide/archetypes/#goalkeeper-features","title":"Goalkeeper Features","text":"Feature Description <code>pass_success_rate</code> % of successful distributions <code>avg_pass_distance</code> Mean distribution distance <code>long_pass_pct</code> % of long distributions <code>under_pressure_pct</code> % of distributions under pressure"},{"location":"guide/profiler/","title":"Building Profiles","text":"<p>The <code>PlayerProfiler</code> class handles the pipeline from raw data to player profiles.</p>"},{"location":"guide/profiler/#basic-usage","title":"Basic Usage","text":"<pre><code>from src.core import PlayerProfiler\n\nprofiler = PlayerProfiler(min_entries=3)\nprofiler.load_data()\nprofiler.detect_entries()\nprofiler.build_profiles()\nprofiler.add_ages()\n</code></pre>"},{"location":"guide/profiler/#one-liner","title":"One-liner","text":"<pre><code>profiler = PlayerProfiler.from_skillcorner(min_entries=3)\n</code></pre>"},{"location":"guide/profiler/#inspecting-results","title":"Inspecting Results","text":"<pre><code>summary = profiler.get_summary()\nprint(f\"Profiles: {summary['profiles_built']}\")\n\nprofile = profiler.get_player_profile(\"Z. Clough\")\nprint(f\"Danger rate: {profile['danger_rate']}%\")\n</code></pre>"},{"location":"guide/reports/","title":"AI Reports","text":"<p>Generate AI-powered scouting insights comparing A-League players to world-class archetypes.</p>"},{"location":"guide/reports/#overview","title":"Overview","text":"<p>The AI reports system supports multiple backends to generate contextual scouting recommendations:</p> Backend Models Setup GitHub Models Phi-4, GPT-4o Mini <code>github_token.txt</code> or <code>GITHUB_TOKEN</code> env HuggingFace Llama 3.1/3.2, Qwen 2.5, SmolLM3, Gemma 2 <code>hf_token.txt</code> or <code>HF_TOKEN</code> env <p>Reports are position-aware and enriched with ML model confidence scores and dataset statistics.</p>"},{"location":"guide/reports/#setup","title":"Setup","text":""},{"location":"guide/reports/#option-1-github-token-recommended","title":"Option 1: GitHub Token (Recommended)","text":"<ol> <li>Go to github.com/settings/tokens</li> <li>Generate a new token with default permissions</li> <li>Save it to <code>github_token.txt</code> in the project root</li> </ol> <pre><code>export GITHUB_TOKEN=your_token_here\n</code></pre>"},{"location":"guide/reports/#option-2-huggingface-token","title":"Option 2: HuggingFace Token","text":"<ol> <li>Go to huggingface.co/settings/tokens</li> <li>Create a token with Inference Providers permission</li> <li>Save it to <code>hf_token.txt</code> in the project root</li> </ol> <pre><code>export HF_TOKEN=your_token_here\n</code></pre>"},{"location":"guide/reports/#basic-usage","title":"Basic Usage","text":"<pre><code>from src.utils.ai_insights import (\n    generate_similarity_insight,\n    generate_player_report,\n    has_valid_token,\n)\n\n# check token exists\nif has_valid_token():\n    insight = generate_similarity_insight(\n        ranked_players,\n        archetype,\n        top_n=5,\n        position_type=\"forward\",\n    )\n    print(insight)\n</code></pre>"},{"location":"guide/reports/#position-aware-insights","title":"Position-Aware Insights","text":"<p>The AI receives different context based on position type. Each position has specific metrics that matter most for scouting.</p>"},{"location":"guide/reports/#forward-metrics","title":"Forward Metrics","text":"<ul> <li>Danger Rate: percentage of entries leading to shots</li> <li>Central %: how often player operates centrally</li> <li>Separation: distance from nearest defender</li> <li>Entry Speed: pace entering final third</li> <li>Carry %: dribbling vs passing entries</li> </ul>"},{"location":"guide/reports/#defender-metrics","title":"Defender Metrics","text":"<ul> <li>Stop Danger Rate: percentage of engagements stopping danger</li> <li>Reduce Danger Rate: engagements reducing but not stopping danger</li> <li>Pressing Rate: proactive engagement tendency</li> <li>Goal Side Rate: maintaining goal-side position</li> <li>Engagement Distance: how far from goal when engaging</li> </ul>"},{"location":"guide/reports/#goalkeeper-metrics","title":"Goalkeeper Metrics","text":"<ul> <li>Pass Success Rate: distribution accuracy</li> <li>Pass Distance: average distribution length</li> <li>Long Pass %: direct distribution tendency</li> <li>Quick Distribution %: speed of restarts</li> </ul>"},{"location":"guide/reports/#what-gets-sent-to-the-ai","title":"What Gets Sent to the AI","text":"<p>The prompt includes:</p> <ol> <li>Position type and archetype name</li> <li>Dataset size (events and players)</li> <li>ML model AUC score (reliability indicator)</li> <li>Position-specific evaluation criteria</li> <li>Top 5 candidates with their metrics</li> <li>Dataset averages for comparison</li> </ol> <p>No raw tracking data or player identifiers beyond names are sent.</p>"},{"location":"guide/reports/#example-output","title":"Example Output","text":"<p>For a forward archetype like Alvarez:</p> <p>Z. Clough from Adelaide United emerges as the closest match with an 88.7% similarity score. His 50% danger rate indicates clinical finishing similar to Alvarez, though with fewer total entries (4 vs typical 8+).</p> <p>The key difference between Clough and Alvarez lies in movement patterns. While Clough shows strong separation metrics (8.2m), his central percentage is lower than the archetype target, suggesting he drifts wide more often.</p> <p>For further observation, T. Payne at 22 years old offers the best development potential despite a lower current similarity score. His high entry speed and willingness to attack centrally mirror Alvarez's profile.</p>"},{"location":"guide/reports/#customisation","title":"Customisation","text":""},{"location":"guide/reports/#change-model","title":"Change Model","text":"<pre><code># Available models:\n# GitHub: \"phi-4\", \"gpt-4o-mini\"\n# HuggingFace: \"llama-3.1-8b\", \"llama-3.2-3b\", \"qwen-2.5-7b\", \"smollm3-3b\", \"gemma-2-2b\"\n\ninsight = generate_similarity_insight(\n    ranked,\n    archetype,\n    model=\"llama-3.1-8b\",  # or any model above\n    position_type=\"forward\",\n)\n</code></pre>"},{"location":"guide/reports/#individual-player-reports","title":"Individual Player Reports","text":"<pre><code>from src.utils.ai_insights import generate_player_report\n\nreport = generate_player_report(\n    player_name=\"Z. Clough\",\n    player_profile=player_dict,\n    similarity_score=88.7,\n    archetype=archetype,\n    position_type=\"forward\",\n)\n</code></pre>"},{"location":"guide/reports/#ml-model-context","title":"ML Model Context","text":"<p>The AI receives the ML model's AUC score to calibrate confidence:</p> Position AUC Interpretation Forward 0.656 Moderate reliability, more uncertainty Defender 0.845 Good reliability Goalkeeper 0.993 Excellent reliability <p>Higher AUC means the underlying similarity rankings are more trustworthy, which the AI factors into its recommendations.</p>"},{"location":"guide/reports/#streamlit-integration","title":"Streamlit Integration","text":"<p>The interactive app includes AI insights in a dedicated tab:</p> <pre><code># in app.py\nif has_valid_token():\n    with st.spinner(\"Generating AI scouting insight...\"):\n        insight = generate_similarity_insight(\n            results, archetype, top_n=5, position_type=position_type\n        )\n    st.markdown(insight)\n</code></pre>"},{"location":"guide/similarity/","title":"Computing Similarity","text":"<p>The <code>SimilarityEngine</code> computes weighted cosine similarity between players and an archetype.</p>"},{"location":"guide/similarity/#basic-usage","title":"Basic Usage","text":"<pre><code>from src.core import Archetype, SimilarityEngine\n\narchetype = Archetype.alvarez()\nengine = SimilarityEngine(archetype)\nengine.fit(profiler.profiles)\nrankings = engine.rank(top_n=10)\n</code></pre>"},{"location":"guide/similarity/#explaining-scores","title":"Explaining Scores","text":"<pre><code>explanation = engine.explain(\"Z. Clough\")\nprint(f\"Score: {explanation['similarity_score']}%\")\n</code></pre>"},{"location":"guide/similarity/#feature-importance","title":"Feature Importance","text":"<pre><code>importance = engine.get_feature_importance()\nfor item in importance:\n    print(f\"{item['feature']}: {item['weight']:.2%}\")\n</code></pre>"}]}